---
date created: 2022-04-08 15:56
---

# Backup

有两种人：

- 做备份的人
- 那些会做备份的人

您拥有但尚未备份的任何数据都是随时可能永远消失的数据。 在这里，我们将介绍一些好的备份基础知识和一些方法的缺陷。

## 3-2-1 规则

。 [3-2-1 规则](https://www.us-cert.gov/sites/default/files/publications/data_backup_options.pdf) 是备份数据的一般推荐策略 它指出您应该拥有：

- 至少 **3 份** 数据
- **2** 份 **不同媒介**
- **1** 个副本在 **异地**

这个建议背后的主要思想是不要把所有的鸡蛋都放在一个篮子里。 拥有 2 个不同的设备/磁盘可确保单个硬件故障不会带走您的所有数据。 同样，如果您将唯一的备份存储在家里，而房子被烧毁或被盗，您将失去一切，这就是异地副本的用途。 现场备份为您提供可用性和速度，异地备份为您提供灾难发生时的弹性。

## 测试你的备份

执行备份时的一个常见缺陷是盲目相信系统所说的一切，而不是验证数据是否可以正确恢复。

## 版本控制

您应该明白 [RAID](https://en.wikipedia.org/wiki/RAID) 不是备份，一般来说 **镜像也不是备份解决方案** 。 在某些情况下，简单地在某处同步您的文件将无济于事，例如：

- 数据损坏
- 恶意软件
- 误删文件

如果您的数据更改传播到备份，那么您将无法在这些情况下恢复。 请注意，许多云存储解决方案都属于这种情况，例如 Dropbox、Google Drive、One Drive 等。 其中一些确实会在短时间内保留已删除的数据，但通常要恢复的界面不是您想要用来恢复大量文件的东西。

应该对适当的备份系统进行版本控制，以防止这种故障模式。 通过及时提供不同的快照，人们可以轻松地导航它们以恢复丢失的任何内容。 最广为人知的此类软件是 macOS Time Machine。

## 重复数据删除

但是，就磁盘空间而言，制作多个数据副本可能会非常昂贵。 然而，从一个版本到下一个版本，大部分数据都是相同的，不需要再次传输。 这就是 [重复数据删除](https://en.wikipedia.org/wiki/Data_deduplication) 发挥作用的地方，通过跟踪已经存储的内容，可以进行 **增量备份** ，其中只需要存储从一个版本到下一个版本的更改。 这显着减少了第一个副本之外的备份所需的空间量。

## 加密

由于我们可能会向云提供商等不受信任的第三方进行备份，因此值得考虑的是，如果您备份的数据是按原样复制 _的，_ 那么它可能会被不需要的代理查看。 税收等文件属于敏感信息，不应以纯格式备份。 为了防止这种情况，许多备份解决方案提供 **客户端加密** ，其中数据在发送到服务器之前被加密。 这样服务器就无法读取它存储的数据，但您可以使用您的密钥对其进行解密。

附带说明一下，如果您的磁盘（或主分区）未加密，那么任何掌握您计算机的人都可以设法覆盖用户访问控制并读取您的数据。 现代硬件支持快速高效地读取和写入加密数据，因此您可能需要考虑启用 **全盘加密** 。

## 仅附加

到目前为止审查的属性集中在硬件故障或用户错误，但未能解决如果恶意代理想要删除您的数据会发生什么。 也就是说，假设有人入侵了您的系统，他们是否能够擦除您关心的所有数据副本？ 如果您担心这种情况，那么您需要某种仅附加备份解决方案。 一般来说，这意味着拥有一个允许您发送新数据但拒绝删除现有数据的服务器。 通常用户有两个密钥，一个支持创建新备份的仅附加密钥和一个还允许删除不再需要的旧备份的完整访问密钥。 后者是离线存储的。

请注意，这是一个非常具有挑战性的场景，因为您需要能够进行更改，同时仍要防止恶意用户删除您的数据。 现有的商业解决方案包括 [Tarsnap](https://www.tarsnap.com/) 和 [Borgbase](https://www.borgbase.com/) 。

## 其他注意事项

您可能想要研究的其他一些事情是：

- **定期备份** ：过时的备份可能变得毫无用处。 定期进行备份应该是您系统的考虑因素
- **可启动备份** ：某些程序允许您克隆整个磁盘。 这样，您就有了一个包含整个系统副本的映像，您可以直接从中引导。
- **差异备份策略** ，您可能不一定关心所有数据。 您可以为不同类型的数据定义不同的备份策略。
- **仅附加备份** 另一个考虑因素是对备份存储库强制执行仅附加操作，以防止恶意代理在获取您的计算机时将其删除。

## 网页服务

并非您使用的所有数据都保存在硬盘上。 如果您使用 **网络** 服务，那么您关心的某些数据（例如 Google Docs 演示文稿或 Spotify 播放列表）可能会在线存储。 另一个容易忘记的简单示例是具有 Web 访问权限的电子邮件帐户，例如 Gmail。 在这些情况下找出备份解决方案有点棘手。 但是，有许多服务允许您直接或通过 API 下载数据。 工具 [gmvault](https://github.com/gaubert/gmvault) 将电子邮件文件下载到您的计算机。

## 网页

同样，一些高质量的内容也可以以网页的形式在网上找到。 如果所述内容是静态的，只需保存网站及其所有附件即可轻松备份。 另一种选择是 [Wayback Machine](https://archive.org/web/) 管理的大型万维网数字档案，这是 [Internet Archive](https://archive.org/) 一个专注于保存各种媒体的非营利组织。 Wayback Machine 允许您捕获和存档网页，以便以后检索已为该网站存档的所有快照。 如果您觉得它有用，请考虑 [捐款](https://archive.org/donate/) 向该项目

## 资源

我们使用过的一些好的备份程序和服务可以诚实地推荐：

- [Tarsnap](https://www.tarsnap.com/) - 为真正的偏执狂提供重复数据删除、加密的在线备份服务。
- [Borg Backup](https://borgbackup.readthedocs.io) - 支持压缩和认证加密的去重备份程序。 如果您需要云提供商 [rsync.net](https://www.rsync.net/products/borg.html) 为 Borg 用户提供了特殊产品。
- [rsync](https://rsync.samba.org/) 是一个提供快速增量文件传输的实用程序。 它不是一个完整的备份解决方案。
- [rclone](https://rclone.org/) 与 rsync 类似，但适用于 Amazon S3、Dropbox、Google Drive、rsync.net 等云存储提供商。 支持远程文件夹的客户端加密。
